define(["jquery"],function(e){var f=function(){m();};var m=function(){(function(){var r=parseInt(window.screen.height,10)-120;e(".go-jd").css("top",r/2+"px");
}());e("#buy-car").on("click",function(){e("#notice-wrap").remove();e.post(URL+"/getBuyPage",function(r){var s=e(r.content);s.appendTo(e("body"));e("#user-name").val(j("userName"));
e("#user-addr").val(j("userAddr"));e("#user-phone").val(j("userPhone"));},"json");});e(".notice-box-close").live("click",function(){e("#notice-wrap").remove();
});e(".login-btn").live("click",function(){e("#notice-wrap").remove();e.post(URL+"/quickLogin",function(r){var s=e(r.content);s.appendTo(e("body"));},"json");
});e(".register-btn").live("click",function(){e("#notice-wrap").remove();e.post(URL+"/quickRegister",function(r){var s=e(r.content);s.appendTo(e("body"));
},"json");});e("#get-login").live("click",l);e(".form-login #password").live("keypress",function(r){if(r.keyCode==13){l();}});e(".form-register input").live("blur",g);
e("#get-register").live("click",k);e("#verify").live("click",function(){var r=new Date().getTime();e("#verify").attr("src",APP+"/Public/verifyCode/"+r);
});e("#submit-check-btn").live("click",b);e("#my-already-buy").live("click",n);e(".already-buy-list-item .btn-danger").live("click",a);e(".already-buy-list-item .btn-pass").live("click",c);
e(".show-list").live("click",function(){e("#notice-wrap").remove();n();});};var a=function(){var r=confirm("确认取消订单么？不可恢复喔！");if(r){var t=e(this).attr("itemId"),s=e(this);
e.post(URL+"/deleteItem",{itemId:t},function(u){if(u.flag){s.parent().remove();alert("取消成功!您还可以去挑选其他物品喔！5% 等待你");}},"json");}};var c=function(){var r=confirm("您确认收到货了么？谨慎标记喔!");
if(r){var t=e(this).attr("itemId"),s=e(this);e.post(URL+"/completeItem",{itemId:t},function(u){if(u.flag){s.parent().remove();alert("确认成功!");window.location.reload();
}},"json");}};var n=function(){e.post(URL+"/getAlreadyBuy",function(r){var s=e(r.content);s.appendTo(e("body"));},"json");};var b=function(){var r=true;
e.each(e("input.buy-car-input"),function(y,x){if(e.trim(e(x).val())===""){e(x).css("border","1px solid #f00");e(x).parent().find(".register-notice").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/error.png' />");
r=false;}else{e(x).css("border","1px solid #CCCCCC");e(x).parent().find(".register-notice").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/ok.png' />");
}});if(!r){return;}e("#submit-check-btn").unbind("click",b).addClass("disabled").html("正在提交...");var v=e.trim(e("#item-url").val()),w=e.trim(e("#user-name").val()),u=e.trim(e("#user-addr").val()),t=e.trim(e("#user-phone").val()),s=e.trim(e("#user-addition").val());
o("userName",w);o("userPhone",t);o("userAddr",u);e.post(URL+"/saveBuyCar",{url:v,userName:w,userAddr:u,userPhone:t,userAddition:s},function(x){if(x.flag){e(".notice-box-content").html(x.context);
}else{alert("提交失败！");window.location.reload();}},"json");};var q=/^[a-zA-Z0-9-._]{1,50}@[a-zA-Z0-9-]{1,65}.(com|net|org|info|biz|([a-z]{2,3}.[a-z]{2}))$/i,p=/[1-9][0-9]{4,10}/,i=/^[a-z0-9_-]{6,18}$/i,h=/^[a-z0-9_\u4E00-\u9FFF]{2,15}$/i;
var l=function(){var t=e("#user"),s=e.trim(t.val()),v=e("#password"),r=e.trim(v.val()),u=e("#tip");if(s==""||r==""){u.text("输入不能为空");t.focus();return;}if(!q.test(s)&&!p.test(s)){u.text("账号格式错误");
t.focus();return;}if(!i.test(r)){u.text("密码格式错误");v.focus();return;}e("#get-login").addClass("disabled").html("登录中...").unbind("click",l);e.ajax({type:"post",url:APP+"/Login/getLogin",data:{user:s.toLowerCase(),pwd:r,autoLogin:1},success:function(w){if(!w.isFit){u.css({display:"block"}).text("账号或者密码错误");
e("#get-login").removeClass("disabled").bind("click",l).html("登录");}else{u.text(w.msg);window.location.reload();}},dataType:"json"});};var g=function(){var v=e(this),t=e("#tip"),r=e.trim(v.val()),s=v.attr("input_type"),u=v.parent().find(".register-notice");
if(r==""){v.css({border:"1px solid red"});t.html("填写的内容不能为空");u.html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/error.png' />");
return;}else{v.css({border:"1px solid #cccccc"});u.css("color","#A8A8A8").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/ok.png' />");
}if(s==="mail"){if(!q.test(r)){v.css({border:"1px solid red"});t.html("邮箱地址错误");u.css("color","#f00").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/error.png' />");
return;}else{v.css({border:"1px solid #cccccc"});t.html("");u.css("color","#A8A8A8").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/ok.png' />");
}}else{if(s==="pwd"){if(!i.test(r)){v.css({border:"1px solid red"});t.html("密码不符合规范");u.css("color","#f00").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/error.png' />");
return;}else{v.css({border:"1px solid #cccccc"});t.html("");u.css("color","#A8A8A8").html("<img class='valid-tip' src='http://t.xiaoplus.com/style/img/common/icon/ok.png' />");
}}}};var k=function(){var w=e("#pwd"),r=e.trim(w.val()),t=e("#email"),s=e.trim(t.val()),v=e("#verifyCode"),u=e.trim(v.val());tipBox=e("#tip");if(r==""||s==""){tipBox.text("输入不能为空");
return;}if(!q.test(s)){tipBox.text("邮箱格式错误");t.focus();return;}if(!i.test(r)){tipBox.text("密码格式错误");w.focus();return;}e("#get-register").addClass("disabled").unbind("click",k).html("正在注册中...");
e.post(APP+"/Register/registerSubmit",{userName:"用户"+Math.random().toString().substr(2,10),mail:s.toLowerCase(),pwd:r,verify:u},function(y){if(!!y.isFit){e("#get-register").removeClass("disabled").html("注册成功!");
window.location.reload();}else{tipBox.text(y.msg);var x=new Date().getTime();e("#get-register").removeClass("disabled").bind("click",k).html("重新注册");e("#verify").attr("src",domainExtraURL+"/Public/verifyCode/"+x);
}},"json");};function o(t,v){var r=o.arguments;var w=o.arguments.length;var s=(w>2)?r[2]:null;if(s!=null){var u=new Date();u.setTime(u.getTime()+(s*1000*3600*24));
}document.cookie=t+"="+escape(v)+((s==null)?"":("; expires="+u.toGMTString()));}function j(r){var s=r+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(s);
if(offset!=-1){offset+=s.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length;}return unescape(document.cookie.substring(offset,end));
}else{return"";}}}function d(r){var s=new Date();s.setTime(s.getTime()-(86400*1000*1));o(r,"",s);}return{initialize:f};});